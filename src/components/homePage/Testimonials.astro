---
import { getCollectionByPriority } from "../../lib/content/getCollectionItems.ts";
import type { ColorKey } from "../../lib/designSystem/colors.ts";
import Reel from "../Reel.svelte";
import Surface from "../Surface.astro";

const surfaceColors: ColorKey[] = ["red-1", "blue-1", "green-1"];

const testimonials = await getCollectionByPriority("testimonials");
const getRotate = (index: number) => ((index % 2) - 0.5) * 3;
const getColor = (index: number) => surfaceColors[index % surfaceColors.length];
---

<Reel client:idle>
  <div class="reel">
    {
      testimonials.map(({ title, url, Content }, index) => (
        <div class="item">
          <Surface background={getColor(index)} rotate={getRotate(index)}>
            <blockquote>
              <Content />
            </blockquote>
            <p class="text-right">
              <cite>{url ? <a href={url}>{title}</a> : title}</cite>
            </p>
          </Surface>
        </div>
      ))
    }
  </div>
</Reel>
